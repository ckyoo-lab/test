<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê´€ë¦¬ì í˜ì´ì§€ - ìˆ˜ì¶œë°”ìš°ì²˜ ì»¨ì„¤íŒ…</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f7fa;
            color: #333;
        }

        .login-container {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 2rem;
        }

        .login-box {
            background: white;
            padding: 3rem;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            max-width: 400px;
            width: 100%;
        }

        .login-box h1 {
            color: #1e3c72;
            margin-bottom: 2rem;
            text-align: center;
        }

        .admin-container {
            display: none;
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 2rem;
            margin-bottom: 2rem;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .subtitle {
            opacity: 0.9;
        }

        .logout-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        .logout-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        .tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            border-bottom: 2px solid #e0e0e0;
            background: white;
            padding: 0 1rem;
            border-radius: 10px 10px 0 0;
        }

        .tab {
            padding: 1rem 2rem;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 1rem;
            font-weight: bold;
            color: #666;
            transition: all 0.3s;
            position: relative;
        }

        .tab.active {
            color: #667eea;
        }

        .tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 3px;
            background: #667eea;
        }

        .tab:hover {
            color: #667eea;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .card {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            margin-bottom: 2rem;
        }

        .card h2 {
            color: #1e3c72;
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        thead {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
        }

        th, td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        th {
            font-weight: bold;
            color: #1976d2;
        }

        tr:hover {
            background: #f5f5f5;
        }

        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            margin-right: 5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-success {
            background: #4caf50;
            color: white;
        }

        .btn-warning {
            background: #ff9800;
            color: white;
        }

        .btn-danger {
            background: #f44336;
            color: white;
        }

        .btn-sm {
            padding: 5px 10px;
            font-size: 0.9rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: #1e3c72;
            font-weight: bold;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 5px;
            font-size: 1rem;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .status-badge {
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.85rem;
            font-weight: bold;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
        }

        .status-completed {
            background: #d4edda;
            color: #155724;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-header h2 {
            color: #1e3c72;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #999;
        }

        .close-btn:hover {
            color: #333;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1.5rem;
            border-radius: 10px;
            text-align: center;
        }

        .stat-card h3 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .stat-card p {
            opacity: 0.9;
        }

        .loading {
            text-align: center;
            padding: 2rem;
            color: #667eea;
        }

        .empty-state {
            text-align: center;
            padding: 3rem;
            color: #999;
        }
    </style>
</head>
<body>
    <!-- ë¡œê·¸ì¸ í™”ë©´ -->
    <div class="login-container" id="loginContainer">
        <div class="login-box">
            <h1>ğŸ” ê´€ë¦¬ì ë¡œê·¸ì¸</h1>
            <form id="loginForm" onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label for="loginEmail">ì´ë©”ì¼</label>
                    <input type="email" id="loginEmail" required>
                </div>
                <div class="form-group">
                    <label for="loginPassword">ë¹„ë°€ë²ˆí˜¸</label>
                    <input type="password" id="loginPassword" required>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">ë¡œê·¸ì¸</button>
            </form>
        </div>
    </div>

    <!-- ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ -->
    <div class="admin-container" id="adminContainer">
        <header>
            <div>
                <h1>ğŸ” ê´€ë¦¬ì í˜ì´ì§€</h1>
                <p class="subtitle">ìˆ˜ì¶œë°”ìš°ì²˜ ì»¨ì„¤íŒ… ê´€ë¦¬ ì‹œìŠ¤í…œ</p>
            </div>
            <button class="logout-btn" onclick="handleLogout()">ë¡œê·¸ì•„ì›ƒ</button>
        </header>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('dashboard')">ğŸ“Š ëŒ€ì‹œë³´ë“œ</button>
            <button class="tab" onclick="switchTab('contacts')">ğŸ“§ ë¬¸ì˜ ê´€ë¦¬</button>
            <button class="tab" onclick="switchTab('faqs')">â“ FAQ ê´€ë¦¬</button>
        </div>

        <!-- ëŒ€ì‹œë³´ë“œ -->
        <div id="dashboard" class="tab-content active">
            <div class="stats">
                <div class="stat-card">
                    <h3 id="totalContacts">0</h3>
                    <p>ì´ ë¬¸ì˜ ê±´ìˆ˜</p>
                </div>
                <div class="stat-card">
                    <h3 id="pendingContacts">0</h3>
                    <p>ë¯¸ë‹µë³€ ë¬¸ì˜</p>
                </div>
                <div class="stat-card">
                    <h3 id="totalFAQs">0</h3>
                    <p>FAQ í•­ëª© ìˆ˜</p>
                </div>
            </div>

            <div class="card">
                <h2>ìµœê·¼ ë¬¸ì˜</h2>
                <div id="recentContacts" class="loading">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
            </div>
        </div>

        <!-- ë¬¸ì˜ ê´€ë¦¬ -->
        <div id="contacts" class="tab-content">
            <div class="card">
                <h2>ë¬¸ì˜ ê´€ë¦¬</h2>
                <div id="contactsList" class="loading">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
            </div>
        </div>

        <!-- FAQ ê´€ë¦¬ -->
        <div id="faqs" class="tab-content">
            <div class="card">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                    <h2 style="margin: 0;">FAQ ê´€ë¦¬</h2>
                    <button class="btn btn-primary" onclick="openFAQModal()">+ ìƒˆ FAQ ì¶”ê°€</button>
                </div>
                <div id="faqsList" class="loading">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
            </div>
        </div>
    </div>

    <!-- ë¬¸ì˜ ìƒì„¸ ëª¨ë‹¬ -->
    <div id="contactModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ë¬¸ì˜ ìƒì„¸</h2>
                <button class="close-btn" onclick="closeModal('contactModal')">&times;</button>
            </div>
            <div id="contactDetail"></div>
        </div>
    </div>

    <!-- FAQ í¸ì§‘ ëª¨ë‹¬ -->
    <div id="faqModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="faqModalTitle">FAQ ì¶”ê°€</h2>
                <button class="close-btn" onclick="closeModal('faqModal')">&times;</button>
            </div>
            <form id="faqForm" onsubmit="saveFAQ(event)">
                <input type="hidden" id="faqId">
                <div class="form-group">
                    <label for="faqQuestion">ì§ˆë¬¸ *</label>
                    <input type="text" id="faqQuestion" required>
                </div>
                <div class="form-group">
                    <label for="faqAnswer">ë‹µë³€ *</label>
                    <textarea id="faqAnswer" required></textarea>
                </div>
                <div class="form-group">
                    <label for="faqOrder">ìˆœì„œ</label>
                    <input type="number" id="faqOrder" value="1" min="1">
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">ì €ì¥</button>
            </form>
        </div>
    </div>

    <script>
        // Supabase ì„¤ì • (index.htmlê³¼ ë™ì¼í•˜ê²Œ ì„¤ì •)
        const SUPABASE_URL = 'YOUR_SUPABASE_URL';
        const SUPABASE_KEY = 'YOUR_SUPABASE_ANON_KEY';
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

        let currentEditingFAQ = null;
        let currentUser = null;

        // ë¡œê·¸ì¸ ì²˜ë¦¬
        async function handleLogin(e) {
            e.preventDefault();
            
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            try {
                const { data, error } = await supabase.auth.signInWithPassword({
                    email: email,
                    password: password
                });
                
                if (error) throw error;
                
                currentUser = data.user;
                document.getElementById('loginContainer').style.display = 'none';
                document.getElementById('adminContainer').style.display = 'block';
                loadDashboard();
            } catch (error) {
                alert('ë¡œê·¸ì¸ ì‹¤íŒ¨: ' + error.message);
            }
        }

        // ë¡œê·¸ì•„ì›ƒ
        async function handleLogout() {
            await supabase.auth.signOut();
            currentUser = null;
            document.getElementById('loginContainer').style.display = 'flex';
            document.getElementById('adminContainer').style.display = 'none';
        }

        // ì„¸ì…˜ í™•ì¸
        async function checkSession() {
            const { data: { session } } = await supabase.auth.getSession();
            if (session) {
                currentUser = session.user;
                document.getElementById('loginContainer').style.display = 'none';
                document.getElementById('adminContainer').style.display = 'block';
                loadDashboard();
            }
        }

        // íƒ­ ì „í™˜
        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
            
            if (tabName === 'dashboard') loadDashboard();
            if (tabName === 'contacts') loadContacts();
            if (tabName === 'faqs') loadFAQsAdmin();
        }

        // ëŒ€ì‹œë³´ë“œ ë¡œë“œ
        async function loadDashboard() {
            try {
                const { data: contacts } = await supabase.from('contacts').select('*');
                const { data: faqs } = await supabase.from('faqs').select('*');
                
                document.getElementById('totalContacts').textContent = contacts ? contacts.length : 0;
                document.getElementById('pendingContacts').textContent = 
                    contacts ? contacts.filter(c => c.status === 'ë¯¸ë‹µë³€').length : 0;
                document.getElementById('totalFAQs').textContent = faqs ? faqs.length : 0;
                
                const recentDiv = document.getElementById('recentContacts');
                if (!contacts || contacts.length === 0) {
                    recentDiv.innerHTML = '<div class="empty-state"><p>ì•„ì§ ë¬¸ì˜ê°€ ì—†ìŠµë‹ˆë‹¤.</p></div>';
                } else {
                    contacts.sort((a, b) => new Date(b.created_at) - new Date(a.created_at));
                    const recent = contacts.slice(0, 5);
                    
                    recentDiv.innerHTML = `
                        <table>
                            <thead>
                                <tr>
                                    <th>ë‚ ì§œ</th>
                                    <th>ì´ë¦„/íšŒì‚¬</th>
                                    <th>ì´ë©”ì¼</th>
                                    <th>ìƒíƒœ</th>
                                    <th>ì•¡ì…˜</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${recent.map(c => `
                                    <tr>
                                        <td>${new Date(c.created_at).toLocaleDateString('ko-KR')}</td>
                                        <td>${c.name}</td>
                                        <td>${c.email}</td>
                                        <td><span class="status-badge ${c.status === 'ë‹µë³€ì™„ë£Œ' ? 'status-completed' : 'status-pending'}">${c.status}</span></td>
                                        <td><button class="btn btn-sm btn-primary" onclick='viewContact(${JSON.stringify(c)})'>ìƒì„¸ë³´ê¸°</button></td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    `;
                }
            } catch (error) {
                console.error('ëŒ€ì‹œë³´ë“œ ë¡œë“œ ì‹¤íŒ¨:', error);
            }
        }

        // ë¬¸ì˜ ëª©ë¡ ë¡œë“œ
        async function loadContacts() {
            try {
                const { data: contacts, error } = await supabase
                    .from('contacts')
                    .select('*')
                    .order('created_at', { ascending: false });
                
                const contactsDiv = document.getElementById('contactsList');
                
                if (error) throw error;
                
                if (!contacts || contacts.length === 0) {
                    contactsDiv.innerHTML = '<div class="empty-state"><p>ì•„ì§ ë¬¸ì˜ê°€ ì—†ìŠµë‹ˆë‹¤.</p></div>';
                    return;
                }
                
                contactsDiv.innerHTML = `
                    <table>
                        <thead>
                            <tr>
                                <th>ë‚ ì§œ</th>
                                <th>ì´ë¦„/íšŒì‚¬</th>
                                <th>ì´ë©”ì¼</th>
                                <th>ì—°ë½ì²˜</th>
                                <th>ìƒíƒœ</th>
                                <th>ì•¡ì…˜</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${contacts.map(c => `
                                <tr>
                                    <td>${new Date(c.created_at).toLocaleString('ko-KR')}</td>
                                    <td>${c.name}</td>
                                    <td>${c.email}</td>
                                    <td>${c.phone}</td>
                                    <td><span class="status-badge ${c.status === 'ë‹µë³€ì™„ë£Œ' ? 'status-completed' : 'status-pending'}">${c.status}</span></td>
                                    <td>
                                        <button class="btn btn-sm btn-primary" onclick='viewContact(${JSON.stringify(c)})'>ìƒì„¸</button>
                                        <button class="btn btn-sm btn-success" onclick="updateContactStatus(${c.id}, 'ë‹µë³€ì™„ë£Œ')">ì™„ë£Œ</button>
                                        <button class="btn btn-sm btn-danger" onclick="deleteContact(${c.id})">ì‚­ì œ</button>
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;
            } catch (error) {
                console.error('ë¬¸ì˜ ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨:', error);
                document.getElementById('contactsList').innerHTML = '<p>ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>';
            }
        }

        // ë¬¸ì˜ ìƒì„¸ ë³´ê¸°
        function viewContact(contact) {
            document.getElementById('contactDetail').innerHTML = `
                <div style="margin-bottom: 1rem;">
                    <strong>ì´ë¦„/íšŒì‚¬:</strong> ${contact.name}
                </div>
                <div style="margin-bottom: 1rem;">
                    <strong>ì´ë©”ì¼:</strong> ${contact.email}
                </div>
                <div style="margin-bottom: 1rem;">
                    <strong>ì—°ë½ì²˜:</strong> ${contact.phone}
                </div>
                <div style="margin-bottom: 1rem;">
                    <strong>ë¬¸ì˜ì¼:</strong> ${new Date(contact.created_at).toLocaleString('ko-KR')}
                </div>
                <div style="margin-bottom: 1rem;">
                    <strong>ìƒíƒœ:</strong> <span class="status-badge ${contact.status === 'ë‹µë³€ì™„ë£Œ' ? 'status-completed' : 'status-pending'}">${contact.status}</span>
                </div>
                <div style="margin-bottom: 1rem;">
                    <strong>ë¬¸ì˜ ë‚´ìš©:</strong>
                    <div style="background: #f5f5f5; padding: 1rem; border-radius: 5px; margin-top: 0.5rem; white-space: pre-wrap;">${contact.message}</div>
                </div>
                <div style="display: flex; gap: 0.5rem; margin-top: 1.5rem;">
                    <button class="btn btn-success" onclick="updateContactStatus(${contact.id}, 'ë‹µë³€ì™„ë£Œ'); closeModal('contactModal'); loadContacts();">ë‹µë³€ ì™„ë£Œ ì²˜ë¦¬</button>
                    <button class="btn btn-danger" onclick="deleteContact(${contact.id}); closeModal('contactModal'); loadContacts();">ì‚­ì œ</button>
                </div>
            `;
            document.getElementById('contactModal').classList.add('active');
        }

        // ë¬¸ì˜ ìƒíƒœ ì—…ë°ì´íŠ¸
        async function updateContactStatus(id, status) {
            try {
                const { error } = await supabase
                    .from('contacts')
                    .update({ status: status })
                    .eq('id', id);
                
                if (error) throw error;
                
                alert('ìƒíƒœê°€ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤.');
                loadContacts();
                loadDashboard();
            } catch (error) {
                console.error('ìƒíƒœ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:', error);
                alert('ì—…ë°ì´íŠ¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // ë¬¸ì˜ ì‚­ì œ
        async function deleteContact(id) {
            if (!confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            
            try {
                const { error } = await supabase
                    .from('contacts')
                    .delete()
                    .eq('id', id);
                
                if (error) throw error;
                
                alert('ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
                loadContacts();
                loadDashboard();
            } catch (error) {
                console.error('ì‚­ì œ ì‹¤íŒ¨:', error);
                alert('ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // FAQ ëª©ë¡ ë¡œë“œ
        async function loadFAQsAdmin() {
            try {
                const { data: faqs, error } = await supabase
                    .from('faqs')
                    .select('*')
                    .order('order_num', { ascending: true });
                
                const faqsDiv = document.getElementById('faqsList');
                
                if (error) throw error;
                
                if (!faqs || faqs.length === 0) {
                    faqsDiv.innerHTML = '<div class="empty-state"><p>ë“±ë¡ëœ FAQê°€ ì—†ìŠµë‹ˆë‹¤.</p></div>';
                    return;
                }
                
                faqsDiv.innerHTML = `
                    <table>
                        <thead>
                            <tr>
                                <th style="width: 80px;">ìˆœì„œ</th>
                                <th>ì§ˆë¬¸</th>
                                <th>ë‹µë³€</th>
                                <th style="width: 200px;">ì•¡ì…˜</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${faqs.map(faq => `
                                <tr>
                                    <td>${faq.order_num}</td>
                                    <td>${faq.question}</td>
                                    <td>${faq.answer.substring(0, 50)}${faq.answer.length > 50 ? '...' : ''}</td>
                                    <td>
                                        <button class="btn btn-sm btn-warning" onclick='editFAQ(${JSON.stringify(faq)})'>ìˆ˜ì •</button>
                                        <button class="btn btn-sm btn-danger" onclick="deleteFAQ(${faq.id})">ì‚­ì œ</button>
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;
            } catch (error) {
                console.error('FAQ ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨:', error);
                document.getElementById('faqsList').innerHTML = '<p>ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>';
            }
        }

        // FAQ ëª¨ë‹¬ ì—´ê¸°
        function openFAQModal() {
            currentEditingFAQ = null;
            document.getElementById('faqModalTitle').textContent = 'FAQ ì¶”ê°€';
            document.getElementById('faqForm').reset();
            document.getElementById('faqId').value = '';
            document.getElementById('faqModal').classList.add('active');
        }

        // FAQ í¸ì§‘
        function editFAQ(faq) {
            currentEditingFAQ = faq;
            document.getElementById('faqModalTitle').textContent = 'FAQ ìˆ˜ì •';
            document.getElementById('faqId').value = faq.id;
            document.getElementById('faqQuestion').value = faq.question;
            document.getElementById('faqAnswer').value = faq.answer;
            document.getElementById('faqOrder').value = faq.order_num;
            document.getElementById('faqModal').classList.add('active');
        }

        // FAQ ì €ì¥
        async function saveFAQ(e) {
            e.preventDefault();
            
            const id = document.getElementById('faqId').value;
            const faqData = {
                question: document.getElementById('faqQuestion').value,
                answer: document.getElementById('faqAnswer').value,
                order_num: parseInt(document.getElementById('faqOrder').value)
            };
            
            try {
                if (id) {
                    // ìˆ˜ì •
                    const { error } = await supabase
                        .from('faqs')
                        .update(faqData)
                        .eq('id', id);
                    
                    if (error) throw error;
                } else {
                    // ì¶”ê°€
                    const { error } = await supabase
                        .from('faqs')
                        .insert([faqData]);
                    
                    if (error) throw error;
                }
                
                alert('FAQê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
                closeModal('faqModal');
                loadFAQsAdmin();
                loadDashboard();
            } catch (error) {
                console.error('FAQ ì €ì¥ ì‹¤íŒ¨:', error);
                alert('ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        // FAQ ì‚­ì œ
        async function deleteFAQ(id) {
            if (!confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            
            try {
                const { error } = await supabase
                    .from('faqs')
                    .delete()
                    .eq('id', id);
                
                if (error) throw error;
                
                alert('ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
                loadFAQsAdmin();
                loadDashboard();
            } catch (error) {
                console.error('ì‚­ì œ ì‹¤íŒ¨:', error);
                alert('ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // ëª¨ë‹¬ ë‹«ê¸°
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ì‹œ ë‹«ê¸°
        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.classList.remove('active');
                }
            });
        });

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì„¸ì…˜ í™•ì¸
        window.addEventListener('load', checkSession);
    </script>
</body>
</html>